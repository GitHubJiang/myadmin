<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>一表人才app下载</title>
  </head>
  <body>
  	<script>
  		function ajax(type,url,data,callback){
			var xmlhttp; 
			//创建xmlhttp对象
			if (window.XMLHttpRequest) 
			    xmlhttp=new XMLHttpRequest(); 
			else 
			    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

			xmlhttp.onreadystatechange=callbacksuccess    //回调函数
			xmlhttp.open(type,url,true);     //发送ajax
			xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
			xmlhttp.send(data);  //get时data为null
			function callbacksuccess(){
			  if (xmlhttp.readyState==4 && xmlhttp.status==200){
			     	if(typeof callback =='function') callback(JSON.parse(xmlhttp.responseText));
			        // documrnt.getElementById("textarea").value = xmlhttp.responseText;  //服务器返回数据为xmlhttp.responseText
			     }
			}
		};
  		var browser = {
	        versions: function() {
				var u = navigator.userAgent,
				    app = navigator.appVersion;
				return {
					trident: u.indexOf('Trident') > -1,                        /*IE内核*/
					presto: u.indexOf('Presto') > -1,          /*opera内核*/
					webKit: u.indexOf('AppleWebKit') > -1, /*苹果、谷歌内核*/
					gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1,        /*火狐内核*/
					mobile: !!u.match(/AppleWebKit.*Mobile.*/),        /*是否为移动终端*/
					ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), /*ios终端*/
					android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, /*android终端或者uc浏览器*/
					iPhone: u.indexOf('iPhone') > -1,          /*是否为iPhone或者QQHD浏览器*/
					iPad: u.indexOf('iPad') > -1,      /*是否iPad*/
					webApp: u.indexOf('Safari') == -1,          /*是否web应该程序，没有头部与底部*/
					souyue: u.indexOf('souyue') > -1,
					superapp: u.indexOf('superapp') > -1,
					weixin:u.toLowerCase().indexOf('micromessenger') > -1,
					Safari:u.indexOf('Safari') > -1
				};
	          }(),
	        language: (navigator.browserLanguage || navigator.language).toLowerCase()
		};
		// _ios_url = 'http://172.16.52.86:8104/apps?page=1&page_size=1&name=jlb&type=ios&channel=test',
		// _android_url = 'http://172.16.52.86:8104/apps?page=1&page_size=1&name=jlb&type=android&channel=test';
		
		if (browser.versions.ios) {
			ajax('get','http://172.16.52.86:8104/apps?page=1&page_size=1&name=jlb&type=ios&channel=test',{},function(res){
				if(res.data.result.length>0){
					var _url = res.data.result[0].url;
					window.location.href = _url;
					setTimeout(function(){
					    window.location.href = _url;
					    window.location.href = _url;  
					},2000)
				}else{
					console.log('没有app！')
				}
			});
		}else if (browser.versions.android){
			ajax('get','http://172.16.52.86:8104/apps?page=1&page_size=1&name=jlb&type=android&channel=test',{},function(res){
				if(res.data.result.length>0){
					var _url = res.data.result[0].url;
					window.location.href = _url;
					setTimeout(function(){
					    window.location.href = _url;
					},2000)
				}
				else{
					console.log('没有app！')
				}
			});
		}
  	</script>
  </body>
</html>
